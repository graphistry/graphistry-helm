.. This page has been autogenerated using Frigate.
   https://frigate.readthedocs.io

Postgrescluster
======================

A postgres cluster Helm chart for Graphistry on Kubernetes

Install Postgres Cluster
-------------------------
**NOTE:** This chart requires the Postgres Operator to be installed. See :doc:`postgres-operator-docs` for information on how to install the Postgres Operator.

  .. tabs::

    .. tab:: Local from Source
      .. code-block:: shell-session            
                
        git clone https://github.com/graphistry/graphistry-helm && cd graphistry-helm
        helm upgrade -i  postgres-cluster ./charts/postgres-cluster --namespace graphistry --create-namespace 

    .. tab:: From Graphistry Helm Repo
      .. code-block:: shell-session            
                
        helm repo add graphistry-helm https://graphistry.github.io/graphistry-helm/
        helm upgrade -i postgrescluster graphistry-helm/postgres-cluster --namespace graphistry --create-namespace  


Configuring Postgres Cluster
----------------------------

After Cluster is deployed, find the pv that is created and add the following label to it. This will allow the cluster to bind the pv to the pod upon redeployment.
      
    .. code-block:: shell-session


      kubectl get pv -n graphistry && kubectl label pv <pv name> pgo-postgres-cluster=graphistry-postgres        

Change the postgres password if needed. The default password is randomly generated AlphaNumeric string.

    .. code-block:: shell-session


      kubectl patch secret -n postgres-operator postgres-pguser-graphistry -p '{"stringData":{"password":"<password>","verifier":""}}'


Configuration
-------------

The following table lists the configurable parameters of the Postgrescluster chart and their default values.

================================================== ==================================================================================================== ==================================================
Parameter                                          Description                                                                                          Default
================================================== ==================================================================================================== ==================================================
``global.provisioner``                                                                                                                                  ``"kubernetes.io/aws-ebs"``                       
``global.multiNode``                                                                                                                                    ``false``                                         
``global.containerregistry.name``                                                                                                                       ``"acrgraphistryk8s.azurecr.io"``                 
``global.devMode``                                                                                                                                      ``false``                                         
``global.postgres.repository``                                                                                                                          ``"graphistry-postgres"``                         
``global.postgres.name``                                                                                                                                ``"graphistry"``                                  
``global.postgres.user``                                                                                                                                ``"graphistry"``                                  
``global.postgres.port``                                                                                                                                ``5432``                                          
``global.postgres.host``                                                                                                                                ``"postgres"``                                    
``global.tag``                                                                                                                                          ``"latest"``                                      
``global.imagePullPolicy``                         could also be Always                                                                                 ``"IfNotPresent"``                                
``global.restartPolicy``                                                                                                                                ``"Always"``                                      
``global.imagePullSecrets``                                                                                                                             ``[]``                                            
``global.nodeSelector``                                                                                                                                 ``null``                                          
``global.logs.LogLevel``                                                                                                                                ``"INFO"``                                        
``global.logs.GraphistryLogLevel``                                                                                                                      ``"INFO"``                                        
================================================== ==================================================================================================== ==================================================






